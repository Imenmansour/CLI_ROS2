concepts intermediate concepts the ros_domain_id edit on github the ros_domain_id ï overview ï as explained elsewhere, the default middleware that ros 2 uses for communication is dds. in dds, the primary mechanism for having different logical networks share a physical network is known as the domain id. ros 2 nodes on the same domain can freely discover and send messages to each other, while ros 2 nodes on different domains cannot. all ros 2 nodes use domain id 0 by default. to avoid interference between different groups of computers running ros 2 on the same network, a different domain id should be set for each group. choosing a domain id (short version) ï the text below explains the derivation of the range of domain ids that should be used in ros 2. to skip that background and just choose a safe number, simply choose a domain id between 0 and 101, inclusive. choosing a domain id (long version) ï the domain id is used by dds to compute the udp ports that will be used for discovery and communication. see this article for details on how the ports are computed. remembering our basic networking, the udp port is an unsigned 16-bit integer . thus, the highest port number that can be allocated is 65535. doing some math with the formula in the article above, this means that the highest domain id that can possibly be assigned is 232, while the lowest that can be assigned is 0. platform-specific constraints ï for maximum compatibility, some additional platform-specific constraints should be followed when choosing a domain id. in particular, it is best to avoid allocating domain ids in the operating systemâs ephemeral port range . this avoids possible conflicts between the ports used by the ros 2 nodes and other networking services on the computers. here are some platform-specific notes  ephemeral ports. linux macos windows by default, the linux kernel uses ports 32768-60999 for ephemeral ports. this means that domain ids 0-101 and 215-232 can be safely used without colliding with ephemeral ports. the ephemeral port range is configurable in linux by setting custom values in /proc/sys/net/ipv4/ip_local_port_range . if a custom ephemeral port range is used, the above numbers may have to be adjusted accordingly. by default, the ephemeral port range on macos is 49152-65535. this means that domain ids 0-166 can be safely used without colliding with ephemeral ports. the ephemeral port range is configurable in macos by setting custom sysctl values for net.inet.ip.portrange.first and net.inet.ip.portrange.last . if a custom ephemeral port range is used, the above numbers may have to be adjusted accordingly. by default, the ephemeral port range on windows is 49152-65535. this means that domain ids 0-166 can be safely used without colliding with ephemeral ports. the ephemeral port range is configurable in windows by using netsh . if a custom ephemeral port range is used, the above numbers may have to be adjusted accordingly. participant constraints ï for each ros 2 process running on a computer, one dds âparticipantâ is created. since each dds participant takes up two ports on the computer, running more than 120 ros 2 processes on one computer may spill over into other domain ids or the ephemeral ports. to see why, consider the domain ids 1 and 2. domain id 1 uses port 7650 and 7651 for multicast. domain id 2 uses port 7900 and 7901 for multicast. when creating the 1st process (zeroth participant) in domain id 1, the ports 7660 and 7661 are used for unicast. when creating the 120th process (119th participant) in domain id 1, the ports 7898 and 7899 are used for unicast. when creating the 121st process (120th participant) in domain id 1, the ports 7900 and 7901 are used for unicast and overlap with domain id 2. if it is known that the computer will only ever be on a single domain id at a time, and the domain id is low enough, it is safe to create more ros 2 processes than this. when choosing a domain id that is near the top of the range of platform-specific domain ids, one additional constraint should be considered. for instance, assume a linux computer with a domain id of 101: the zeroâth ros 2 process on the computer will connect to ports 32650, 32651, 32660, and 32661. the first ros 2 process on the computer will connect to ports 32650, 32651, 32662, and 32663. the 53rd ros 2 process on the computer will connect to ports 32650, 32651, 32766, and 32767. the 54th ros 2 process on the computer will connect to ports 32650, 32651, 32768, and 32769, running into the ephemeral port range. thus the maximum number of processes that should be created when using domain id 101 on linux is 54. similarly, the maximum number of processes that should be created when using domain id 232 on linux is 63, as the maximum port number is 65535. the situation is similar on macos and windows, though the numbers are different. on macos and windows, when choosing a domain id of 166 (the top of the range), the maximum number of ros 2 processes that can be created on a computer before running into the ephemeral port range is 120. domain id to udp port calculator ï domain id: participant id: discovery multicast port: user multicast port: discovery unicast port: user unicast port: other versions v: jazzy releases jazzy (latest) iron humble galactic (eol) foxy (eol) eloquent (eol) dashing (eol) crystal (eol) in development rolling